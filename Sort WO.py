import os
import shutil


def unique_Wo_numbers_list():
    list_of_numbers = """1295416
1304057
1368995
1368996
1295417
1304065
1368997
1304066
1369021
1369022
1304052
1369009
1304077
1369005
1304058
1369001
1328862
1369010
1328855
1369007
1304081
1369004
1304075
1383237
1328851
1369003
1383226
1304070
1369016
1383229
1384109
1304061
1366686
1368998
1383231
1304060
1369012
1384103
1304069
1379814
1383578
1384120
1308210
1379808
1328881
1382842
1328873
1382644
1328859
1382361
1328878
1382831
1328854
1382849
1330200
1382007
1382858
1309367
1342891
1382013
1382346
1309373
1342898
1382344
1309372
1342896
1382349
1309823
1342888
1382341
1309814
1342889
1382347
1309812
1382340
1309816
1368227
1309820
1368220
1382843
1308943
1368222
1382838
1309813
1368223
1382854
1310036
1368221
1310055
1368224
1382840
1308947
1368225
1308946
1368219
1310034
1368278
1383374
1310045
1310047
1309815
1309826
1309832
1309827
1308950
1310096
1310088
1309577
1373964
1310051
1373881
1310304
1373933
1310324
1373874
1312290
1373927
1328807
1373961
1328802
1369014
1328809
1369019
1331218
1331220
1298803
1298801
1298817
1298806
1298797
1298802
1304095
1304093
1304097
1304101
1304099
1304094
1304088
1304090
1304089
1304091
1304102
1323169
1323172
1323167
1323168
1323171
1323170
1323173
1323176
1323166
1323174
1323175
1342885
1142886
1366663
1367227
1363597
1363732
1366639
1366690
1367235
1363746
1363749
1366949
1363756
1363767
1366665
1363604"""

    # Split the input string into a list of lines
    lines = list_of_numbers.splitlines()

    # Convert each line to an integer
    numbers = [int(line) for line in lines]
    print(numbers)
    unique_numbers = set(numbers)

    new_list_of_numbers = list(unique_numbers)

    print(new_list_of_numbers)


def view_files_from_path():
    # Get the list of all files in the directory.
    files = os.listdir(path)

    # Filter the list to only include PDF files.
    pdf_files = [file for file in files if file.endswith(".pdf")]

    # Print the list of PDF files.
    return pdf_files


def make_folders():
    for i in Wo_numbers_unique:
        os.mkdir(Wo_path + "\\" + str(i))


def validate_input(sb_number):
    for i in pdfs:
        if i[0:len(sb_number)] == sb_number:
            return True
    else:
        return False


Wo_numbers_unique = [401878658, 401827074, 401841154, 401841031, 401878668, 401894413, 401840786, 401865491, 401840788, 401841302, 401875100, 401887390, 401878687, 401865248, 401884833, 401852834, 401840677, 401840678, 401865254, 401840808, 401841317, 401876142, 401878576, 401840820, 401876918, 401865656, 401840697, 401848634, 401840763, 401880893, 401879998, 401892157, 401854269, 401840710, 401865543, 401865290, 401893067, 401878348, 401840716, 401884622, 401879882, 401854282, 401863250, 401880403, 401840982, 401848409, 401840986, 401875292, 401854302, 401857762, 401884903, 401891431, 401865196, 401880303, 401848432, 401840756, 401865462, 401879546, 401878907, 401875710]


Sb_no = [1295416, 1304057, 1368995, 1368996, 1295417, 1304065, 1368997, 1304066, 1369021, 1369022, 1304052, 1369009, 1304077, 1369005, 1304058, 1369001, 1328862, 1369010, 1328855, 1369007, 1304081, 1369004, 1304075, 1383237, 1328851, 1369003, 1383226, 1304070, 1369016, 1383229, 1384109, 1304061, 1366686, 1368998, 1383231, 1304060, 1369012, 1384103, 1304069, 1379814, 1383578, 1384120, 1308210, 1379808, 1328881, 1382842, 1328873, 1382644, 1328859, 1382361, 1328878, 1382831, 1328854, 1382849, 1330200, 1382007, 1382858, 1309367, 1342891, 1382013, 1382346, 1309373, 1342898, 1382344, 1309372, 1342896, 1382349, 1309823, 1342888, 1382341, 1309814, 1342889, 1382347, 1309812, 1382340, 1309816, 1368227, 1309820, 1368220, 1382843, 1308943, 1368222, 1382838, 1309813, 1368223, 1382854, 1310036, 1368221, 1310055, 1368224, 1382840, 1308947, 1368225, 1308946, 1368219, 1310034, 1368278, 1383374, 1310045, 1310047, 1309815, 1309826, 1309832, 1309827, 1308950, 1310096, 1310088, 1309577, 1373964, 1310051, 1373881, 1310304, 1373933, 1310324, 1373874, 1312290, 1373927, 1328807, 1373961, 1328802, 1369014, 1328809, 1369019, 1331218, 1331220, 1298803, 1298801, 1298817, 1298806, 1298797, 1298802, 1304095, 1304093, 1304097, 1304101, 1304099, 1304094, 1304088, 1304090, 1304089, 1304091, 1304102, 1323169, 1323172, 1323167, 1323168, 1323171, 1323170, 1323173, 1323176, 1323166, 1323174, 1323175, 1342885, 1142886, 1366663, 1367227, 1363597, 1363732, 1366639, 1366690, 1367235, 1363746, 1363749, 1366949, 1363756, 1363767, 1366665, 1363604]


Wo_no = [401880403, 401880893, 401840710, 401878687, 401878658, 401880403, 401827074, 401878658, 401884903, 401840820, 401875710, 401880403, 401876142, 401840697, 401884833, 401879998, 401876918, 401840788, 401876918, 401880893, 401875710, 401884622, 401884833, 401875710, 401876918, 401840678, 401878658, 401878348, 401878907, 401880403, 401865462, 401876142, 401892157, 401880303, 401876142, 401878348, 401878668, 401840756, 401884903, 401879546, 401880893, 401840786, 401878658, 401887390, 401854302, 401878348, 401841302, 401887390, 401840808, 401863250, 401840763, 401865254, 401840716, 401865543, 401848409, 401884903, 401879546, 401892157, 401840716, 401878687, 401878348, 401879998, 401840788, 401840820, 401884903, 401848432, 401879998, 401878668, 401848634, 401884903, 401879998, 401840982, 401884833, 401878907, 401854302, 401880303, 401857762, 401880403, 401840982, 401865656, 401876142, 401841031, 401865290, 401878668, 401875710, 401865491, 401878348, 401841154, 401884903, 401854302, 401865248, 401878576, 401840677, 401879546, 401893067, 401878907, 401840697, 401865196, 401880303, 401880303, 401884833, 401878348, 401878668, 401879546, 401875100, 401875100, 401854269, 401840820, 401894413, 401879882, 401840678, 401879546, 401878907, 401878668, 401884833, 401884903, 401878668, 401848634, 401884622, 401840820, 401879882, 401878348, 401876918, 401879546, 401880403, 401878907, 401875710, 401854269, 401852834, 401854282, 401875292, 401880303, 401878907, 401894413, 401840678, 401852834, 401875292, 401879882, 401852834, 401893067, 401875292, 401854269, 401875292, 401854269, 401852834, 401894413, 401841317, 401884833, 401884622, 401891431, 401875710, 401891431, 401880893, 401841317, 401848409, 401840677, 401840710, 401840986, 401848432, 401854302, 401854302, 401876142, 401857762, 401848432, 401840756, 401840808, 401840982, 401841031, 401841031]


path = 'C:\\Users\\Customs\\Desktop\\M.V CLIPPER HOUSTON'
Wo_path = 'C:\\Users\\Customs\\PycharmProjects\\WO wise\\WO folders'

pdfs = view_files_from_path()


def validate_input(Sb):
    a = Sb[0:7]
    for i in range(0, len(Sb_no)):
        if a == str(Sb_no[i]):
            return i
    return -1


def main():
    error_log = ""
    for i in pdfs:
        a = validate_input(i)
        if a == -1:
            error_log += i + "  Kindly check this file\n"
        else:
            src = path + "\\" + i
            dest = Wo_path + "\\" + str(Wo_no[a])
            shutil.copy(src, dest)

    if error_log != "":
        # Open the text file in write mode
        with open("error_log.txt", "w") as f:
            # Write the string to the file
            f.write(error_log)

        # Close the file
        f.close()
        print("Error file has been generated Please check!!")

main()
